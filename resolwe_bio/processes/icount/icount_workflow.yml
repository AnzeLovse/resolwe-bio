- slug: workflow-icount
  category: workflow:primary
  name: iCount Pipeline
  requirements:
    expression-engine: jinja
  version: 1.0.0
  type: data:workflow:icount
  input:
    - name: reads
      label: Input reads
      type: data:reads:fastq:single
    - name: index
      label: STAR index of chosen genome.
      type: data:genomeindex:star
    - name: segmentation
      label: Segmentation of chosen genome.
      type: data:annotation:gtf:icount
  run:
    language: workflow
    program:
      - id: starmap
        run: alignment-star
        input:
          genome: '{{input.index}}'
          reads: '{{input.reads}}'
          threads: 2
      - id: xlsites
        run: icount-xlsites
        input:
          bam: '{{steps.starmap}}'
      - id: summary
        run: icount-summary
        input:
          segmentation: '{{input.segmentation}}'
          sites: '{{steps.xlsites}}'
      - id: annotate
        run: icount-annotate
        input:
          segmentation: '{{input.segmentation}}'
          sites: '{{steps.xlsites}}'
      - id: peaks
        run: icount-peaks
        input:
          segmentation: '{{input.segmentation}}'
          sites: '{{steps.xlsites}}'
